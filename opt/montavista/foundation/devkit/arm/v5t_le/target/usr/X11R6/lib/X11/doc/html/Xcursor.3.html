
<!--
  
   $Id$
   
   Copyright © 2002 Keith Packard
   
   Permission to use, copy, modify, distribute, and sell this software and its
   documentation for any purpose is hereby granted without fee, provided that
   the above copyright notice appear in all copies and that both that
   copyright notice and this permission notice appear in supporting
   documentation, and that the name of Keith Packard not be used in
   advertising or publicity pertaining to distribution of the software without
   specific, written prior permission.  Keith Packard makes no
   representations about the suitability of this software for any purpose.  It
   is provided "as is" without express or implied warranty.
   
   KEITH PACKARD DISCLAIMS ALL WARRANTIES WITH REGARD TO THIS SOFTWARE,
   INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS, IN NO
   EVENT SHALL KEITH PACKARD BE LIABLE FOR ANY SPECIAL, INDIRECT OR
   CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE,
   DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER
   TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
   PERFORMANCE OF THIS SOFTWARE.
   
 
-->
<!-- manual page source format generated by PolyglotMan v3.0.8+X.Org, -->
<!-- available at http://polyglotman.sourceforge.net/ -->

<html>
<head>
<title>XCURSOR(3) manual page</title>
</head>
<body bgcolor='#efefef' text='black' link='blue' vlink='#551A8B' alink='red'>
<a href='#toc'>Table of Contents</a><p>

<p> 
<h2><a name='sect0' href='#toc0'>Name</a></h2>
XCURSOR - Cursor management library 
<p> 
<h2><a name='sect1' href='#toc1'>Synopsis</a></h2>
<br>
<pre><b>#include &lt;X11/Xcursor/Xcursor.h&gt;</b>
</pre>
<h2><a name='sect2' href='#toc2'>Description</a></h2>
<b>Xcursor</b> is a simple library designed to help locate and load
cursors.  Cursors can be loaded from files or memory.  A library of common
cursors exists which map to the standard X cursor names.  Cursors can exist
in several sizes and the library automatically picks the best size. 
<p> 
<h2><a name='sect3' href='#toc3'>Functional
Overview</a></h2>
Xcursor is built in a couple of layers; at the bottom layer is
code which can load cursor images from files.  Above that is a layer which
locates cursor files based on the library path and theme.  At the top is
a layer which builds cursors either out of an image loaded from a file
or one of the standard X cursors.  When using images loaded from files,
Xcursor prefers to use the Render extension CreateCursor request if supported
by the X server.  Where not supported, Xcursor maps the cursor image to
a standard X cursor and uses the core CreateCursor request. 
<p> 
<h3><a name='sect4' href='#toc4'>Cursor Files</a></h3>
Xcursor
defines a new format for cursors on disk.  Each file holds one or more cursor
images.  Each cursor image is tagged with a nominal size so that the best
size can be selected automatically.  Multiple cursors of the same nominal
size can be loaded together; applications are expected to use them as an
animated sequence. <p>
Cursor files are stored as a header containing a table
of contents followed by a sequence of chunks.  The table of contents indicates
the type, subtype and position in the file of each chunk.  The file header
looks like: <p>
 <i>magic</i>: CARD32 'Xcur' (0x58, 0x63, 0x75, 0x72) <br>
<i>header</i>: CARD32 bytes in this header <br>
<i>version</i>: CARD32 file version number <br>
<i>ntoc</i>: CARD32 number of toc entries <i>toc</i>: LISTofTOC table of contents  <p>
Each
table of contents entry looks like: <p>
 <i>type</i>: CARD32 entry type <i>subtype</i>: CARD32
type-specific label - size for images <i>position</i>: CARD32 absolute byte position
of table in file  <p>
<p>
Each chunk in the file has set of common header fields
followed by additional type-specific fields: <p>
 <i>header</i>: CARD32 bytes in chunk
header (including type-specific fields) <br>
<i>type</i>: CARD32 must match type in TOC for this chunk <br>
<i>subtype</i>: CARD32 must match subtype in TOC for this chunk <br>
<i>version</i>: CARD32 version number for this chunk type  <p>
There are currently
two chunk types defined for cursor files; comments and images.  Comments
look like: <p>
 <i>header</i>: 20 Comment headers are 20 bytes <br>
<i>type</i>: 0xfffe0001 Comment type is 0xfffe0001 <br>
<i>subtype</i>: { 1 (COPYRIGHT), 2 (LICENSE), 3 (OTHER) } <br>
<i>version</i>: 1 <br>
<i>length</i>: CARD32 byte length of UTF-8 string <br>
<i>string</i>: LISTofCARD8 UTF-8 string  <p>
Images look like: <p>
 <i>header</i>: 36 Image headers
are 36 bytes <br>
<i>type</i>: 0xfffd0002 Image type is 0xfffd0002 <br>
<i>subtype</i>: CARD32 Image subtype is the nominal size <br>
<i>version</i>: 1 <br>
<i>width</i>: CARD32 Must be less than or equal to 0x7fff <br>
<i>height</i>: CARD32 Must be less than or equal to 0x7fff <br>
<i>xhot</i>: CARD32 Must be less than or equal to width <br>
<i>yhot</i>: CARD32 Must be less than or equal to height <br>
<i>delay</i>: CARD32 Delay between animation frames in milliseconds <br>
<i>pixels</i>: LISTofCARD32 Packed ARGB format pixels  
<p> 
<h3><a name='sect5' href='#toc5'>Themes</a></h3>
Xcursor (mostly)
follows the freedesktop.org spec for theming icons.  The default search path
it uses is $HOME/.icons, /usr/share/icons, /usr/share/pimaps, /usr/X11R6/lib/X11/icons.
 Within each of these directorys, it searches for a directory using the
theme name.  Within the theme directory, it looks for cursor files in the
'cursors' subdirectory. It uses the first cursor file found along  the path.
<p>
If necessary, Xcursor also looks for a "index.theme" file in each theme
directory to find inherited themes and searches along the path for those
themes as well. <p>
If no theme is set, or if no cursor is found for the specified
theme, Xcursor checks the "default" theme. 
<p> 
<h2><a name='sect6' href='#toc6'>Datatypes</a></h2>

<p> 
<dl>

<dt><b>XcursorImage</b> </dt>
<dd>holds
a single cursor image in memory.  Each pixel in the cursor is a 32-bit value
containing ARGB with A in the high byte. <p>
<br>
<pre>    typedef struct _XcursorImage {
        XcursorDim<tt>&#32;</tt>&nbsp;<tt>&#32;</tt>&nbsp;size;<tt>&#32;</tt>&nbsp;<tt>&#32;</tt>&nbsp;    
        XcursorDim<tt>&#32;</tt>&nbsp;<tt>&#32;</tt>&nbsp;width;<tt>&#32;</tt>&nbsp;<tt>&#32;</tt>&nbsp;    
        XcursorDim<tt>&#32;</tt>&nbsp;<tt>&#32;</tt>&nbsp;height;<tt>&#32;</tt>&nbsp;<tt>&#32;</tt>&nbsp;    
        XcursorDim<tt>&#32;</tt>&nbsp;<tt>&#32;</tt>&nbsp;xhot;<tt>&#32;</tt>&nbsp;<tt>&#32;</tt>&nbsp;    
        XcursorDim<tt>&#32;</tt>&nbsp;<tt>&#32;</tt>&nbsp;yhot;       
        XcursorPixel    *pixels;    
    } XcursorImage;
</pre>
<p> </dd>

<dt><b>XcursorImages</b> </dt>
<dd>holds multiple XcursorImage structures.  They're all freed
when the XcursorImages is freed. <p>
<br>
<pre>    typedef struct _XcursorImages {
        int             nimage;<tt>&#32;</tt>&nbsp;<tt>&#32;</tt>&nbsp;    
        XcursorImage    **images;   
    } XcursorImages;
</pre>
<p> </dd>

<dt><b>XcursorCursors</b> </dt>
<dd>Holds multiple Cursor objects.  They're all freed when the
XcursorCursors is freed.  These are reference counted so that multiple XcursorAnimate
structures can use the same XcursorCursors. <p>
<br>
<pre>    typedef struct _XcursorCursors {
        Display     *dpy;<tt>&#32;</tt>&nbsp;<tt>&#32;</tt>&nbsp;
        int<tt>&#32;</tt>&nbsp;<tt>&#32;</tt>&nbsp;    ref;<tt>&#32;</tt>&nbsp;<tt>&#32;</tt>&nbsp;
        int<tt>&#32;</tt>&nbsp;<tt>&#32;</tt>&nbsp;    ncursor;<tt>&#32;</tt>&nbsp;<tt>&#32;</tt>&nbsp;
        Cursor<tt>&#32;</tt>&nbsp;<tt>&#32;</tt>&nbsp;    *cursors;<tt>&#32;</tt>&nbsp;<tt>&#32;</tt>&nbsp;
    } XcursorCursors;
</pre>
<p> </dd>

<dt><b>XcursorAnimate</b> </dt>
<dd>References a set of cursors and a sequence within that
set.  Multiple XcursorAnimate structures may reference the same XcursorCursors;
each holds a reference which is removed when the XcursorAnimate is freed.
<p>
<br>
<pre>    typedef struct _XcursorAnimate {
        XcursorCursors   *cursors;  
        int<tt>&#32;</tt>&nbsp;<tt>&#32;</tt>&nbsp;<tt>&#32;</tt>&nbsp;<tt>&#32;</tt>&nbsp; sequence;  
    } XcursorAnimate;
</pre>
<p> </dd>

<dt><b>XcursorFile</b> </dt>
<dd>Xcursor provides an abstract API for accessing the file data.
 Xcursor provides a stdio implementation of this abstract API; applications
are free to create additional implementations.  These functions parallel
the stdio functions in return value and expected argument values; the read
and write functions flip the arguments around to match the POSIX versions.
<p>
<br>
<pre>    typedef struct _XcursorFile {
        void<tt>&#32;</tt>&nbsp;<tt>&#32;</tt>&nbsp;*closure;
        int<tt>&#32;</tt>&nbsp;<tt>&#32;</tt>&nbsp;(*read)  (XcursorFile *file, unsigned char *buf, int len);
        int<tt>&#32;</tt>&nbsp;<tt>&#32;</tt>&nbsp;(*write) (XcursorFile *file, unsigned char *buf, int len);
        int<tt>&#32;</tt>&nbsp;<tt>&#32;</tt>&nbsp;(*seek)  (XcursorFile *file, long offset, int whence);
    };
</pre>
<p> </dd>
</dl>

<h2><a name='sect7' href='#toc7'>Functions</a></h2>

<p> 
<h3><a name='sect8' href='#toc8'>Object Management</a></h3>

<dl>

<dt>XcursorImage *XcursorImageCreate (int width,
int height) </dt>
<dd><br>
 </dd>

<dt> void XcursorImageDestroy (XcursorImage *image) </dt>
<dd>Allocate and free images.
 On allocation, the hotspot and the pixels are left uninitialized.  The
size is set to the maximum of width and height. 
<p> </dd>

<dt>XcursorImages *XcursorImagesCreate
(int size) </dt>
<dd><br>
 </dd>

<dt> void XcursorImagesDestroy (XcursorImages *images) </dt>
<dd>Allocate and free arrays
to hold multiple cursor images.  On allocation, nimage is set to zero. 
<p> </dd>

<dt>XcursorCursors
*XcursorCursorsCreate (Display *dpy, int size) </dt>
<dd><br>
 </dd>

<dt> void XcursorCursorsDestroy (XcursorCursors *cursors) </dt>
<dd>Allocate and free
arrays to hold multiple cursors.  On allocation, ncursor is set to zero,
ref is set to one. 
<p> </dd>
</dl>

<h3><a name='sect9' href='#toc9'>Reading and writing images.</a></h3>

<p> 
<dl>

<dt>XcursorImage *XcursorXcFileLoadImage
(XcursorFile *file, int size) </dt>
<dd><br>
 </dd>

<dt> XcursorImages *XcursorXcFileLoadImages (XcursorFile *file, int size)
</dt>
<dd><br>
 </dd>

<dt> XcursorImages *XcursorXcFileLoadAllImages (XcursorFile *file) </dt>
<dd><br>
 </dd>

<dt> XcursorBool XcursorXcFileLoad (XcursorFile *file, XcursorComments **commentsp,
XcursorImages **imagesp) </dt>
<dd><br>
 </dd>

<dt> XcursorBool XcursorXcFileSave (XcursorFile *file, const XcursorComments
*comments, const XcursorImages *images) </dt>
<dd>These read and write cursors from
an XcursorFile handle.  After reading, the file pointer will be left at
some random place in the file. <tt>&#32;</tt>&nbsp;<tt>&#32;</tt>&nbsp;<tt>&#32;</tt>&nbsp;<tt>&#32;</tt>&nbsp;   <br>
 </dd>

<dt>XcursorImage *XcursorFileLoadImage (FILE *file, int size) </dt>
<dd><br>
 </dd>

<dt> XcursorImages *XcursorFileLoadImages (FILE *file, int size) </dt>
<dd><br>
 </dd>

<dt> XcursorImages *XcursorFileLoadAllImages (FILE *file) </dt>
<dd><br>
 </dd>

<dt> XcursorBool XcursorFileLoad (FILE *file, XcursorComments **commentsp,
XcursorImages **imagesp) </dt>
<dd><br>
 </dd>

<dt> XcursorBool XcursorFileSaveImages (FILE *file, const XcursorImages *images)
</dt>
<dd><br>
 </dd>

<dt> XcursorBool XcursorFileSave (FILE * file, const XcursorComments *comments,
const XcursorImages *images) </dt>
<dd>These read and write cursors from a stdio
FILE handle.  Writing flushes before returning so that any errors should
be detected. 
<p> </dd>

<dt>XcursorImage *XcursorFilenameLoadImage (const char *filename,
int size) </dt>
<dd><br>
 </dd>

<dt> XcursorImages *XcursorFilenameLoadImages (const char *filename, int size)
</dt>
<dd><br>
 </dd>

<dt> XcursorImages *XcursorFilenameLoadAllImages (FILE *file) </dt>
<dd><br>
 </dd>

<dt> XcursorBool XcursorFilenameLoad (const char *file, XcursorComments **commentsp,
XcursorImages **imagesp) </dt>
<dd><br>
 </dd>

<dt> XcursorBool XcursorFilenameSaveImages (const char *filename, const XcursorImages
*images) </dt>
<dd><br>
 </dd>

<dt> XcursorBool XcursorFilenameSave (const char *file, const XcursorComments
*comments, const XcursorImages *images) </dt>
<dd>These parallel the stdio FILE interfaces
above, but take filenames. 
<p> </dd>
</dl>

<h3><a name='sect10' href='#toc10'>Reading library images</a></h3>

<dl>

<dt>XcursorImage *XcursorLibraryLoadImage
(const char *name, const char *theme, int size) </dt>
<dd><br>
 </dd>

<dt> XcursorImages *XcursorLibraryLoadImages (const char *name, const char
*theme, int size) </dt>
<dd>These search the library path, loading the first file
found.  If 'theme' is not NULL, these functions first try appending -theme
to name and then name alone. 
<p> </dd>
</dl>

<h3><a name='sect11' href='#toc11'>Cursor APIs</a></h3>

<p> 
<dl>

<dt>Cursor XcursorFilenameLoadCursor
(Display *dpy, const char *file) </dt>
<dd><br>
 </dd>

<dt> XcursorCursors *XcursorFilenameLoadCursors (Display *dpy, const char
*file) </dt>
<dd>These load cursors from the specified file. 
<p> </dd>

<dt>Cursor XcursorLibraryLoadCursor
(Display *dpy, const char *name) </dt>
<dd><br>
 </dd>

<dt> XcursorCursors *XcursorLibraryLoadCursors (Display *dpy, const char *name)
</dt>
<dd>These load cursors using the specified library name.  The theme comes from
the display. 
<p> </dd>
</dl>

<h3><a name='sect12' href='#toc12'>X Cursor Name APIs</a></h3>

<p> 
<dl>

<dt>XcursorImage *XcursorShapeLoadImage (unsigned
int shape, const char *theme, int size) </dt>
<dd><br>
 </dd>

<dt> XcursorImages *XcursorShapeLoadImages (unsigned int shape, const char
*theme, int size) </dt>
<dd>These map 'shape' to a library name using the standard
X cursor names and then load the images. 
<p> </dd>

<dt>Cursor XcursorShapeLoadCursor
(Display *dpy, unsigned int shape) </dt>
<dd><br>
 </dd>

<dt> XcursorCursors *XcursorShapeLoadCursors (Display *dpy, unsigned int shape)
</dt>
<dd>These map 'shape' to a library name and then load the cursors. 
<p> </dd>
</dl>

<h3><a name='sect13' href='#toc13'>Display Information
APIs</a></h3>

<p> 
<dl>

<dt>XcursorBool XcursorSupportsARGB (Display *dpy) </dt>
<dd>Returns whether the
display supports ARGB cursors or whether cursors will be mapped to a core
X cursor. 
<p> </dd>

<dt>XcursorBool XcursorSetDefaultSize (Display *dpy, int size) </dt>
<dd>Sets
the default size for cursors on the specified display. When loading cursors,
those who's nominal size is closest to this size will be preferred. 
<p> </dd>

<dt>int
XcursorGetDefaultSize (Display *dpy) </dt>
<dd>Gets the default cursor size. 
<p> </dd>

<dt>XcursorBool
</dt>
<dd>XcursorSetTheme (Display *dpy, const char *theme) Sets the current theme
name. 
<p> char * XcursorGetTheme (Display *dpy) Gets the current theme name.

<p> </dd>
</dl>

<h2><a name='sect14' href='#toc14'>Restrictions</a></h2>
<b>Xcursor</b> will probably change radically in the future; weak
attempts will be made to retain some level of source-file compatibility.

<p> 
<h2><a name='sect15' href='#toc15'>Author</a></h2>
Keith Packard <p>

<hr><p>
<a name='toc'><b>Table of Contents</b></a><p>
<ul>
<li><a name='toc0' href='#sect0'>Name</a></li>
<li><a name='toc1' href='#sect1'>Synopsis</a></li>
<li><a name='toc2' href='#sect2'>Description</a></li>
<li><a name='toc3' href='#sect3'>Functional Overview</a></li>
<ul>
<li><a name='toc4' href='#sect4'>Cursor Files</a></li>
<li><a name='toc5' href='#sect5'>Themes</a></li>
</ul>
<li><a name='toc6' href='#sect6'>Datatypes</a></li>
<li><a name='toc7' href='#sect7'>Functions</a></li>
<ul>
<li><a name='toc8' href='#sect8'>Object Management</a></li>
<li><a name='toc9' href='#sect9'>Reading and writing images.</a></li>
<li><a name='toc10' href='#sect10'>Reading library images</a></li>
<li><a name='toc11' href='#sect11'>Cursor APIs</a></li>
<li><a name='toc12' href='#sect12'>X Cursor Name APIs</a></li>
<li><a name='toc13' href='#sect13'>Display Information APIs</a></li>
</ul>
<li><a name='toc14' href='#sect14'>Restrictions</a></li>
<li><a name='toc15' href='#sect15'>Author</a></li>
</ul>
</body>
</html>
