#!/bin/sh
# Script to launch the tracedaemon

TRACER=""

# check for args
if [ $# -ne 2 ]; then
	echo "Usage: ${0##*/} <seconds> <output file basename>"
	exit 1
fi

# check if this is a 2.4 kernel (without relayfs)
if grep "version 2.4" /proc/version >/dev/null; then 
	TRACER=/dev/tracer
fi

# activate tracedaemon
tracedaemon -ts$1 -eSTART -eSYS_ENTRY -eSYS_EXIT -eTRAP_ENTRY -eTRAP_EXIT -eIRQ_ENTRY -eIRQ_EXIT -eSCHED -eKTIMER -eSIRQ -ePROCESS -eFS -eTIMER -eMEM -eSOCKET -eIPC -eNET -eNEWEV -eCSTM -DSTART -DSYS_ENTRY -DSYS_EXIT -DTRAP_ENTRY -DTRAP_EXIT -DIRQ_ENTRY -DIRQ_EXIT -DSCHED -DKTIMER -DSIRQ -DPROCESS -DFS -DTIMER -DMEM -DSOCKET -DIPC -DNET -DNEWEV -DCSTM $TRACER $2.trace $2.proc
