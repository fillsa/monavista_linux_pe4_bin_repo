
<!--
  $Xorg: rstartd.man,v 1.3 2000/08/17 19:54:01 cpqbld Exp $
   Copyright (c) 1993 Quarterdeck Office Systems
   
   Permission to use, copy, modify, distribute, and sell this software and
   its documentation for any purpose is hereby granted without fee, provided
   that the above copyright notice appear in all copies and that both that
   copyright notice and this permission notice appear in supporting
   documentation, and that the name Quarterdeck Office Systems, Inc. not
   be used in advertising or publicity pertaining to distribution of this
   software without specific, written prior permission.
   
   THIS SOFTWARE IS PROVIDED `AS-IS'.  QUARTERDECK OFFICE SYSTEMS, INC.,
   DISCLAIMS ALL WARRANTIES WITH REGARD TO THIS SOFTWARE, INCLUDING WITHOUT
   LIMITATION ALL IMPLIED WARRANTIES OF MERCHANTABILITY, FITNESS FOR A
   PARTICULAR PURPOSE, OR NONINFRINGEMENT.  IN NO EVENT SHALL QUARTERDECK
   OFFICE SYSTEMS, INC., BE LIABLE FOR ANY DAMAGES WHATSOEVER, INCLUDING
   SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES, INCLUDING LOSS OF USE,
   DATA, OR PROFITS, EVEN IF ADVISED OF THE POSSIBILITY THEREOF, AND
   REGARDLESS OF WHETHER IN AN ACTION IN CONTRACT, TORT OR NEGLIGENCE, ARISING
   OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
   
   $XFree86: xc/programs/rstart/rstartd.man,v 1.6 2001/01/27 18:21:05 dawes Exp $
   
 
-->
<!-- manual page source format generated by PolyglotMan v3.0.8+X.Org, -->
<!-- available at http://polyglotman.sourceforge.net/ -->

<html>
<head>
<title>RSTARTD(1) manual page</title>
</head>
<body bgcolor='#efefef' text='black' link='blue' vlink='#551A8B' alink='red'>
<a href='#toc'>Table of Contents</a><p>

<h2><a name='sect0' href='#toc0'><p>
Name</a></h2>
rstartd - a sample implementation of a Remote
Start rsh helper 
<h2><a name='sect1' href='#toc1'>Synopsis</a></h2>
<b>rstartd</b> <p>
<b>rstartd.real</b> [-c <i>configfilename</i>] 
<h2><a name='sect2' href='#toc2'>Description</a></h2>
<p>
<i>Rstartd</i>
is an implementation of a Remote Start "helper" as defined in "A Flexible
Remote Execution Protocol Based on <b>rsh</b>". <p>
This document describes the peculiarities
of <i>rstartd</i> and how it is configured. 
<h2><a name='sect3' href='#toc3'>Options</a></h2>

<dl>

<dt><b>-c <i>configfilename</i></b> </dt>
<dd>This option
specifies the "global" configuration file that <i>rstartd</i> is to read.  Normally,
<i>rstartd</i> is a shell script that invokes <i>rstartd.real</i> with the <b>-c</b> switch, allowing
local configuration of the location of the configuration file.  If <i>rstartd.real</i>
is started without the -c option, it reads  <i>/usr/X11R6/lib/X11/rstart/config</i>.
</dd>
</dl>

<h2><a name='sect4' href='#toc4'>Installation</a></h2>
It is critical to successful interoperation of the Remote Start
protocol that <i>rstartd</i> be installed in a directory which is in the "default"
search path, so that default rsh requests and the ilk will be able to find
it. 
<h2><a name='sect5' href='#toc5'>Configuration and Operation</a></h2>
<i>Rstartd</i> is by design highly configurable.
 One would like things like configuration file locations to be fixed, so
that users and administrators can find them without searching, but reality
is that no two vendors will agree on where things should go, and nobody
thinks the original location is "right".  Thus, <i>rstartd</i> allows one to relocate
<b>all</b> of its files and directories. <p>
<i>Rstartd</i> has a hierarchy of configuration
files which are executed in order when a request is made.  They are:  <p>
 <br>
<pre>global config
per-user ("local") config
global per-context config
per-user ("local") per-context config
config from request
</pre> <p>
  As you might guess from the presence of "config from request", all of
the config files are in the format of an <i>rstart</i> request.  <i>Rstartd</i> defines
a few additional keywords with the INTERNAL- prefix for specifying its configuration.
<p>
<i>Rstartd</i> starts by reading and executing the global config file. This file
will normally specify the locations of the other configuration files and
any systemwide defaults. <p>
<i>Rstartd</i> will then read the user's local config file,
default name $HOME/.rstart. <p>
<i>Rstartd</i> will then start interpreting the request.
<p>
Presumably one of the first lines in the request will be a CONTEXT line.
The context name is converted to lower case. <p>
<i>Rstartd</i> will read the global
config file for that context, default name /usr/X11R6/lib/X11/rstart/contexts/&lt;name&gt;,
if any. <p>
It will then read the user's config file for that context, default
name $HOME/.rstart.contexts/&lt;name&gt;, if any. <p>
(If neither of these exists, <i>rstartd</i>
aborts with a Failure message.) <p>
<i>Rstartd</i> will finish interpreting the request,
and execute the program specified. <p>
This allows the system administrator
and the user a large degree of control over the operation of <i>rstartd</i>.  The
administrator has final say, because the global config file doesn't need
to specify a per-user config file. If it does, however, the user can override
anything from the global file, and can even completely replace the global
context config files. <p>
The config files have a somewhat more flexible format
than requests do; they are allowed to contain blank lines and lines beginning
with "#" are comments and ignored.  (#s in the middle of lines are data,
not comment markers.) <p>
Any commands run are provided a few useful pieces
of information in environment variables.  The exact names are configurable,
but the supplied defaults are:  <p>
 <br>
<pre>$RSTART_CONTEXT<tt>&#32;</tt>&nbsp;<tt>&#32;</tt>&nbsp;<tt>&#32;</tt>&nbsp;<tt>&#32;</tt>&nbsp;the name of the context
$RSTART_GLOBAL_CONTEXTS<tt>&#32;</tt>&nbsp;<tt>&#32;</tt>&nbsp;the global contexts directory
$RSTART_LOCAL_CONTEXTS<tt>&#32;</tt>&nbsp;<tt>&#32;</tt>&nbsp;the local contexts directory
$RSTART_GLOBAL_COMMANDS<tt>&#32;</tt>&nbsp;<tt>&#32;</tt>&nbsp;the global generic commands directory
$RSTART_LOCAL_COMMANDS<tt>&#32;</tt>&nbsp;<tt>&#32;</tt>&nbsp;the local generic commands directory
</pre> <p>
  $RSTART_{GLOBAL,LOCAL}_CONTEXTS should contain one special file, @List,
which contains a list of the contexts in that directory in the format specified
for ListContexts.  The supplied version of ListContexts will cat both the
global and local copies of @List. <p>
Generic commands are searched for in several
places: (defaults)  <p>
 <br>
<pre>per-user per-context directory ($HOME/.rstart.commands/&lt;context&gt;)
global per-context directory (/usr/X11R6/lib/X11/rstart/commands/&lt;context&gt;)
per-user all-contexts directory ($HOME/.rstart.commands)
global all-contexts directory (/usr/X11R6/lib/X11/rstart/commands)
</pre> <p>
  (Yes, this means you can't have an all-contexts generic command with the
same name as a context.  It didn't seem like a big deal.) <p>
Each of these directories
should have a file called @List that gives the names and descriptions of
the commands in that directory in the format specified for ListGenericCommands.

<h2><a name='sect6' href='#toc6'>Configuration Keywords</a></h2>
There are several "special" <i>rstart</i> keywords defined
for <i>rstartd</i> configuration.  Unless otherwise specified, there are no defaults;
related features are disabled in this case. <p>

<dl>

<dt><b>INTERNAL-REGISTRIES name ...</b> </dt>
<dd>Gives
a space-separated list of "MISC" registries that this system understands.
 (Registries other than this are accepted but generate a Warning.) </dd>

<dt><b>INTERNAL-LOCAL-DEFAULT
relative_filename</b> </dt>
<dd>Gives the name ($HOME relative) of the per-user config
file. </dd>

<dt><b>INTERNAL-GLOBAL-CONTEXTS absolute_directory_name</b> </dt>
<dd>Gives the name of the
system-wide contexts directory. </dd>

<dt><b>INTERNAL-LOCAL-CONTEXTS relative_directory_name</b>
</dt>
<dd>Gives the name ($HOME relative) of the per-user contexts directory. </dd>

<dt><b>INTERNAL-GLOBAL-COMMANDS
absolute_directory_name</b> </dt>
<dd>Gives the name of the system-wide generic commands
directory. </dd>

<dt><b>INTERNAL-LOCAL-COMMANDS relative_directory_name</b> </dt>
<dd>Gives the name
($HOME relative) of the per-user generic commands directory. </dd>

<dt><b>INTERNAL-VARIABLE-PREFIX
prefix</b> </dt>
<dd>Gives the prefix for the configuration environment variables <i>rstartd</i>
passes to its kids. </dd>

<dt><b>INTERNAL-AUTH-PROGRAM authscheme program argv[0] argv[1]
...</b> </dt>
<dd>Specifies the program to run to set up authentication for the specified
authentication scheme.  "program argv[0] ..." gives the program to run and
its arguments, in the same form as the EXEC keyword. </dd>

<dt><b>INTERNAL-AUTH-INPUT authscheme</b>
</dt>
<dd>Specifies the data to be given to the authorization program as its standard
input.  Each argument is passed as a single line. $n, where n is a number,
is replaced by the n'th argument to the "AUTH authscheme arg1 arg2 ..." line.
</dd>

<dt><b>INTERNAL-PRINT arbitrary text</b> </dt>
<dd>Prints its arguments as a Debug message.  Mostly
for <i>rstartd</i> debugging, but could be used to debug config files. </dd>
</dl>

<h2><a name='sect7' href='#toc7'>Notes</a></h2>
When
using the C shell, or any other shell which runs a script every time the
shell is started, the script may get run several times. In the worst case,
the script may get run <b>three</b> times:  <p>
 <br>
<pre>By rsh, to run <i>rstartd</i>
By <i>rstartd</i>, to run the specified command
By the command, eg <i>xterm</i>
</pre> <p>
  <i>rstartd</i> currently limits lines, both from config files and requests,
to BUFSIZ bytes. <p>
DETACH is implemented by redirecting file descriptors 0,1,
and 2 to /dev/null and forking before executing the program. <p>
CMD is implemented
by invoking $SHELL (default /bin/sh) with "-c" and the specified command
as arguments. <p>
POSIX-UMASK is implemented in the obvious way. <p>
The authorization
programs are run in the same context as the target program - same environment
variables, path, etc.  Long term this might be a problem. <p>
In the X context,
GENERIC-CMD Terminal runs xterm. In the OpenWindows context, GENERIC-CMD Terminal
runs cmdtool. <p>
In the X context, GENERIC-CMD LoadMonitor runs xload. In the
OpenWindows context, GENERIC-CMD LoadMonitor runs perfmeter. <p>
<b>GENERIC-CMD ListContexts</b>
lists the contents of @List in both the system-wide and per-user contexts
directories.  It is available in all contexts. <p>
<b>GENERIC-CMD ListGenericCommands</b>
lists the contents of @List in the system-wide and per-user commands directories,
including the per-context subdirectories for the current context.  It is
available in all contexts. <p>
<b>CONTEXT None</b> is not implemented. <p>
<b>CONTEXT Default</b>
is really dull. <p>
For installation ease, the "contexts" directory in the distribution
contains a file "@Aliases" which lists a context name and aliases for that
context. This file is used to make symlinks in the contexts and commands
directories. <p>
All <b>MISC</b> values are passed unmodified as environment variables.
<p>
One can mistreat <i>rstartd</i> in any number of ways, resulting in anything from
stupid behavior to core dumps.  Other than by explicitly running programs
I don't think it can write or delete any files, but there's no guarantee
of that.  The important thing is that (a) it probably won't do anything REALLY
stupid and (b) it runs with the user's permissions, so it can't do anything
catastrophic. <p>
@List files need not be complete; contexts or commands which
are dull or which need not or should not be advertised need not be listed.
In particular, per-user @List files should not list things which are in
the system-wide @List files.  In the future, perhaps ListContexts and ListGenericCommands
will automatically suppress lines from the system-wide files when there
are per-user replacements for those lines. <p>
Error handling is OK to weak. 
In particular, no attempt is made to properly report errors on the exec
itself.  (Perversely, exec errors could be reliably reported when detaching,
but not when passing the stdin/out socket to the app.) <p>
If compiled with
-DODT1_DISPLAY_HACK, <i>rstartd</i> will work around a bug in SCO ODT version 1.
 (1.1?)  (The bug is that the X clients are all compiled with a bad library
that doesn't know how to look host names up using DNS. The fix is to look
up a host name in $DISPLAY and substitute an IP address.) This is a trivial
example of an incompatibility that <i>rstart</i> can hide. 
<h2><a name='sect8' href='#toc8'>See Also</a></h2>
<a href='rstart.1.html'>rstart(1)</a>
, <a href='rsh.1.html'>rsh(1)</a>
,
A Flexible Remote Execution Protocol Based on <b>rsh</b> 
<h2><a name='sect9' href='#toc9'>Author</a></h2>
Jordan Brown, Quarterdeck
Office Systems <p>

<hr><p>
<a name='toc'><b>Table of Contents</b></a><p>
<ul>
<li><a name='toc0' href='#sect0'>Name</a></li>
<li><a name='toc1' href='#sect1'>Synopsis</a></li>
<li><a name='toc2' href='#sect2'>Description</a></li>
<li><a name='toc3' href='#sect3'>Options</a></li>
<li><a name='toc4' href='#sect4'>Installation</a></li>
<li><a name='toc5' href='#sect5'>Configuration and Operation</a></li>
<li><a name='toc6' href='#sect6'>Configuration Keywords</a></li>
<li><a name='toc7' href='#sect7'>Notes</a></li>
<li><a name='toc8' href='#sect8'>See Also</a></li>
<li><a name='toc9' href='#sect9'>Author</a></li>
</ul>
</body>
</html>
